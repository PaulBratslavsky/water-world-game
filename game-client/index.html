<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grid Builder</title>
    <link rel="stylesheet" href="/src/style.css" />
  </head>
  <body>
    <div id="controls">
      <div class="control-row">
        <span class="label">Controls:</span>
      </div>
      <div class="control-row">
        <span class="hint">Left-click - Move / Place</span>
      </div>
      <div class="control-row">
        <span class="hint">Right-click - Remove (Build)</span>
      </div>
      <div class="control-row">
        <span class="hint">WASD - Move camera</span>
      </div>
      <div class="control-row">
        <span class="hint">Q/E - Rotate camera</span>
      </div>
      <div class="control-row">
        <span class="hint">B - Toggle build mode</span>
      </div>
      <div class="control-row">
        <span class="hint">R - Rotate structure</span>
      </div>
      <div class="control-row">
        <span class="hint">F - Free placement toggle</span>
      </div>
      <div class="control-row">
        <span class="hint">P - Select blocks</span>
      </div>
      <div class="control-row">
        <span class="hint">Right-click block - Edit material</span>
      </div>
      <div class="control-row">
        <span class="hint">V - Paste (after copy)</span>
      </div>
      <div class="control-row">
        <span class="hint">Scroll - Zoom</span>
      </div>
      <div class="control-row">
        <span class="hint">Esc - Cancel / Exit FP</span>
      </div>
      <div class="control-row">
        <span class="hint">V - Toggle view</span>
      </div>
      <div class="control-row">
        <span class="hint">H - Toggle hover mode</span>
      </div>
      <div class="control-row">
        <span class="hint">Space/C - Fly up/down</span>
      </div>
    </div>

    <div id="hover-indicator">
      <span>HOVER MODE</span>
    </div>

    <div id="view-toggle">
      <button id="view-third" class="view-btn active">3rd Person</button>
      <button id="view-first" class="view-btn">1st Person</button>
    </div>

    <div id="save-controls">
      <button id="save-btn" class="save-btn" title="Save current world">Save</button>
      <button id="join-world-btn" class="join-btn" title="Join a cloud world by ID">Join World</button>
      <button id="clear-local-btn" class="clear-btn" title="Clear locally saved data">Clear Local</button>
      <div id="world-status" class="world-status"></div>
    </div>

    <div id="mode-toggle">
      <button id="mode-move" class="mode-btn active">Move</button>
      <button id="mode-build" class="mode-btn">Build</button>
    </div>

    <div id="build-options">
      <button id="free-placement-btn" class="option-btn" title="Free Placement (F) - Allow overlapping blocks">Free (F)</button>
      <button id="capture-prefab-btn" class="option-btn" title="Select Blocks (P) - Select blocks to cut, copy, delete, or save as prefab">Select (P)</button>
      <button id="wireframe-btn" class="option-btn" title="Toggle Wireframe Mode - Show blocks as wireframes">Wireframe</button>
      <button id="materials-btn" class="option-btn active" title="Toggle Materials - Show/hide material properties">Materials</button>
      <span id="build-level-display" class="build-level" title="Build Level (Space/Shift+Space to change)">Level: 0</span>
      <span class="build-level-hint">Space/Shift adjusts level</span>
    </div>

    <div id="structure-menu"></div>
    <div id="prefab-menu"></div>

    <!-- Join World Modal -->
    <div id="join-world-modal" class="modal-overlay">
      <div class="modal-content">
        <h3 class="modal-title">Join World</h3>
        <div class="modal-body">
          <div class="modal-info">
            <span>Enter a Strapi world ID to connect to cloud saves.</span>
          </div>
          <div class="form-group">
            <label for="world-id-input">World ID</label>
            <input type="text" id="world-id-input" placeholder="Enter Strapi documentId" />
          </div>
          <div class="modal-info" style="font-size: 12px; color: #888;">
            Find this in Strapi admin: Content Manager > Saves > click entry > copy documentId
          </div>
        </div>
        <div class="modal-actions">
          <button id="join-world-cancel-btn" class="modal-btn cancel">Cancel</button>
          <button id="join-world-connect-btn" class="modal-btn save">Connect</button>
        </div>
      </div>
    </div>

    <!-- Selection Action Menu -->
    <div id="selection-action-menu" class="modal-overlay">
      <div class="modal-content selection-menu">
        <h3 class="modal-title">Selection Actions</h3>
        <div class="modal-body">
          <div class="modal-info">
            <span id="selection-block-count">0 blocks selected</span>
          </div>
          <div class="selection-actions">
            <button id="selection-cut-btn" class="action-btn cut" title="Cut (Ctrl+X)">
              <span class="action-icon">âœ‚</span>
              <span class="action-label">Cut</span>
            </button>
            <button id="selection-copy-btn" class="action-btn copy" title="Copy (Ctrl+C)">
              <span class="action-icon">ðŸ“‹</span>
              <span class="action-label">Copy</span>
            </button>
            <button id="selection-delete-btn" class="action-btn delete" title="Delete">
              <span class="action-icon">ðŸ—‘</span>
              <span class="action-label">Delete</span>
            </button>
            <button id="selection-prefab-btn" class="action-btn prefab" title="Create Prefab">
              <span class="action-icon">ðŸ“¦</span>
              <span class="action-label">Create Prefab</span>
            </button>
            <button id="selection-material-btn" class="action-btn material" title="Modify Material">
              <span class="action-icon">ðŸŽ¨</span>
              <span class="action-label">Material</span>
            </button>
          </div>
        </div>
        <div class="modal-actions">
          <button id="selection-cancel-btn" class="modal-btn cancel">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Prefab Save Modal -->
    <div id="prefab-modal" class="modal-overlay">
      <div class="modal-content">
        <h3 class="modal-title">Save Prefab</h3>
        <div class="modal-body">
          <div class="modal-info">
            <span id="prefab-block-count">0 blocks selected</span>
          </div>
          <div class="form-group">
            <label for="prefab-name">Name</label>
            <input type="text" id="prefab-name" placeholder="My Prefab" />
          </div>
          <div class="form-group">
            <label for="prefab-description">Description (optional)</label>
            <input type="text" id="prefab-description" placeholder="A cool structure" />
          </div>
          <div class="form-group">
            <label for="prefab-category">Category</label>
            <select id="prefab-category">
              <option value="user-created">User Created</option>
              <option value="decorative">Decorative</option>
              <option value="structural">Structural</option>
              <option value="furniture">Furniture</option>
            </select>
          </div>
        </div>
        <div class="modal-actions">
          <button id="prefab-cancel-btn" class="modal-btn cancel">Cancel</button>
          <button id="prefab-save-btn" class="modal-btn save">Save</button>
        </div>
      </div>
    </div>

    <!-- Block Editor Modal -->
    <div id="block-editor-modal" class="modal-overlay">
      <div class="modal-content block-editor">
        <h3 class="modal-title">Edit Block: <span id="block-editor-name">Block</span></h3>
        <div class="modal-body">
          <!-- Block Preview -->
          <div class="block-preview-container">
            <div id="block-editor-preview" class="block-preview"></div>
          </div>

          <!-- Color Override -->
          <div class="slider-group">
            <label>Color Override</label>
            <div class="slider-row color-override-row">
              <input type="checkbox" id="block-color-override-enabled" />
              <input type="color" id="block-color-override" value="#808080" />
              <span id="block-color-override-value" class="slider-value">#808080</span>
            </div>
          </div>

          <!-- Material Properties -->
          <div class="slider-group">
            <label>Metalness</label>
            <div class="slider-row">
              <input type="range" id="block-metalness" min="0" max="1" step="0.05" value="0" />
              <span id="block-metalness-value" class="slider-value">0.00</span>
            </div>
          </div>

          <div class="slider-group">
            <label>Roughness</label>
            <div class="slider-row">
              <input type="range" id="block-roughness" min="0" max="1" step="0.05" value="0.7" />
              <span id="block-roughness-value" class="slider-value">0.70</span>
            </div>
          </div>

          <div class="slider-group">
            <label>Emissive Intensity</label>
            <div class="slider-row">
              <input type="range" id="block-emissive-intensity" min="0" max="5" step="0.1" value="0" />
              <span id="block-emissive-intensity-value" class="slider-value">0.0</span>
            </div>
          </div>

          <div class="slider-group">
            <label>Emissive Color</label>
            <div class="slider-row">
              <input type="color" id="block-emissive-color" value="#000000" />
              <span id="block-emissive-color-value" class="slider-value">#000000</span>
            </div>
          </div>

          <div class="slider-group">
            <label>Opacity</label>
            <div class="slider-row">
              <input type="range" id="block-opacity" min="0" max="1" step="0.05" value="1" />
              <span id="block-opacity-value" class="slider-value">1.00</span>
            </div>
          </div>

          <div class="slider-group checkbox-group">
            <label>
              <input type="checkbox" id="block-transparent" />
              Transparent
            </label>
          </div>
        </div>
        <div class="modal-actions">
          <button id="block-editor-cancel-btn" class="modal-btn cancel">Close</button>
          <button id="block-editor-apply-btn" class="modal-btn save">Apply</button>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
